INFO:root:Namespace(model_name='GRU4Rec')
INFO:root:--------------------------------------------- BEGIN: 2023-06-19 23:13:18 ---------------------------------------------
INFO:root:
========================================
 Arguments       | Values               
========================================
 batch_size      | 256                 
 dataset         | Grocery_and_Gourm...
 dropout         | 0                   
 early_stop      | 10                  
 emb_size        | 64                  
 epoch           | 200                 
 eval_batch_size | 256                 
 gpu             |                     
 hidden_size     | 64                  
 history_max     | 20                  
 l2              | 1e-06               
 lr              | 0.001               
 num_neg         | 1                   
 num_workers     | 5                   
 optimizer       | Adam                
 random_seed     | 0                   
 test_all        | 0                   
 topk            | 5,10,20,50          
========================================
INFO:root:Device: cpu
INFO:root:Load corpus from ../data/Grocery_and_Gourmet_Food/SeqReader.pkl
INFO:root:#params: 586816
INFO:root:GRU4Rec(
  (i_embeddings): Embedding(8714, 64)
  (rnn): GRU(64, 64, batch_first=True)
  (out): Linear(in_features=64, out_features=64, bias=True)
)
INFO:root:Optimizer: Adam
INFO:root:Namespace(model_name='GRU4Rec')
INFO:root:--------------------------------------------- BEGIN: 2023-06-19 23:14:41 ---------------------------------------------
INFO:root:
========================================
 Arguments       | Values               
========================================
 batch_size      | 256                 
 dataset         | Grocery_and_Gourm...
 dropout         | 0                   
 early_stop      | 10                  
 emb_size        | 64                  
 epoch           | 200                 
 eval_batch_size | 256                 
 gpu             |                     
 hidden_size     | 64                  
 history_max     | 20                  
 l2              | 1e-06               
 lr              | 0.001               
 num_neg         | 1                   
 num_workers     | 5                   
 optimizer       | Adam                
 random_seed     | 0                   
 test_all        | 0                   
 topk            | 5,10,20,50          
========================================
INFO:root:Device: cpu
INFO:root:Load corpus from ../data/Grocery_and_Gourmet_Food/SeqReader.pkl
INFO:root:#params: 586816
INFO:root:GRU4Rec(
  (i_embeddings): Embedding(8714, 64)
  (rnn): GRU(64, 64, batch_first=True)
  (out): Linear(in_features=64, out_features=64, bias=True)
)
INFO:root:Optimizer: Adam
INFO:root:Epoch 1     loss=0.4891 [7.7 s]    dev=(HR@5:0.2458,NDCG@5:0.1607) [0.6 s] *
INFO:root:Epoch 2     loss=0.4194 [7.6 s]    dev=(HR@5:0.3136,NDCG@5:0.2101) [0.7 s] *
INFO:root:Epoch 3     loss=0.3855 [7.2 s]    dev=(HR@5:0.3291,NDCG@5:0.2205) [0.6 s] *
INFO:root:Epoch 4     loss=0.3631 [7.0 s]    dev=(HR@5:0.3461,NDCG@5:0.2348) [0.6 s] *
INFO:root:Epoch 5     loss=0.3433 [7.4 s]    dev=(HR@5:0.3603,NDCG@5:0.2474) [0.6 s] *
INFO:root:Epoch 6     loss=0.3257 [7.6 s]    dev=(HR@5:0.3705,NDCG@5:0.2539) [0.6 s] *
INFO:root:Epoch 7     loss=0.3125 [7.4 s]    dev=(HR@5:0.3761,NDCG@5:0.2625) [0.6 s] *
INFO:root:Epoch 8     loss=0.2964 [7.3 s]    dev=(HR@5:0.3777,NDCG@5:0.2629) [0.6 s] *
INFO:root:Epoch 9     loss=0.2795 [7.2 s]    dev=(HR@5:0.3750,NDCG@5:0.2615) [0.6 s]
INFO:root:Epoch 10    loss=0.2656 [7.6 s]    dev=(HR@5:0.3759,NDCG@5:0.2609) [0.6 s]
INFO:root:Epoch 11    loss=0.2550 [7.1 s]    dev=(HR@5:0.3775,NDCG@5:0.2622) [0.6 s]
INFO:root:Epoch 12    loss=0.2415 [7.3 s]    dev=(HR@5:0.3793,NDCG@5:0.2663) [0.6 s] *
INFO:root:Epoch 13    loss=0.2325 [7.2 s]    dev=(HR@5:0.3759,NDCG@5:0.2621) [0.6 s]
INFO:root:Epoch 14    loss=0.2217 [7.3 s]    dev=(HR@5:0.3836,NDCG@5:0.2697) [0.6 s] *
INFO:root:Epoch 15    loss=0.2123 [7.4 s]    dev=(HR@5:0.3814,NDCG@5:0.2728) [0.6 s] *
INFO:root:Epoch 16    loss=0.2041 [7.5 s]    dev=(HR@5:0.3799,NDCG@5:0.2720) [0.6 s]
INFO:root:Epoch 17    loss=0.1980 [7.3 s]    dev=(HR@5:0.3790,NDCG@5:0.2742) [0.6 s] *
INFO:root:Epoch 18    loss=0.1896 [7.4 s]    dev=(HR@5:0.3853,NDCG@5:0.2766) [0.6 s] *
INFO:root:Epoch 19    loss=0.1836 [7.1 s]    dev=(HR@5:0.3793,NDCG@5:0.2700) [0.6 s]
INFO:root:Epoch 20    loss=0.1780 [7.5 s]    dev=(HR@5:0.3901,NDCG@5:0.2807) [0.7 s] *
INFO:root:Epoch 21    loss=0.1708 [7.7 s]    dev=(HR@5:0.3849,NDCG@5:0.2793) [0.7 s]
INFO:root:Epoch 22    loss=0.1667 [7.3 s]    dev=(HR@5:0.3774,NDCG@5:0.2750) [0.6 s]
INFO:root:Epoch 23    loss=0.1633 [7.4 s]    dev=(HR@5:0.3791,NDCG@5:0.2752) [0.6 s]
INFO:root:Epoch 24    loss=0.1558 [7.3 s]    dev=(HR@5:0.3758,NDCG@5:0.2720) [0.6 s]
INFO:root:Epoch 25    loss=0.1477 [7.2 s]    dev=(HR@5:0.3767,NDCG@5:0.2717) [0.6 s]
INFO:root:Epoch 26    loss=0.1451 [7.3 s]    dev=(HR@5:0.3834,NDCG@5:0.2769) [0.7 s]
INFO:root:Epoch 27    loss=0.1423 [7.4 s]    dev=(HR@5:0.3876,NDCG@5:0.2792) [0.7 s]
INFO:root:Epoch 28    loss=0.1388 [7.1 s]    dev=(HR@5:0.3831,NDCG@5:0.2795) [0.6 s]
INFO:root:Epoch 29    loss=0.1354 [7.5 s]    dev=(HR@5:0.3885,NDCG@5:0.2816) [0.6 s] *
INFO:root:Epoch 30    loss=0.1279 [7.5 s]    dev=(HR@5:0.3842,NDCG@5:0.2805) [0.6 s]
INFO:root:Epoch 31    loss=0.1274 [7.2 s]    dev=(HR@5:0.3844,NDCG@5:0.2817) [0.6 s] *
INFO:root:Epoch 32    loss=0.1230 [7.2 s]    dev=(HR@5:0.3806,NDCG@5:0.2729) [0.6 s]
INFO:root:Epoch 33    loss=0.1196 [7.2 s]    dev=(HR@5:0.3851,NDCG@5:0.2797) [0.6 s]
INFO:root:Epoch 34    loss=0.1166 [7.2 s]    dev=(HR@5:0.3868,NDCG@5:0.2806) [0.7 s]
INFO:root:Epoch 35    loss=0.1138 [7.5 s]    dev=(HR@5:0.3847,NDCG@5:0.2801) [0.6 s]
INFO:root:Epoch 36    loss=0.1095 [7.7 s]    dev=(HR@5:0.3846,NDCG@5:0.2793) [0.6 s]
INFO:root:Epoch 37    loss=0.1086 [7.3 s]    dev=(HR@5:0.3810,NDCG@5:0.2787) [0.6 s]
INFO:root:Epoch 38    loss=0.1064 [7.5 s]    dev=(HR@5:0.3855,NDCG@5:0.2813) [0.6 s]
INFO:root:Epoch 39    loss=0.1052 [7.2 s]    dev=(HR@5:0.3851,NDCG@5:0.2811) [0.6 s]
INFO:root:Epoch 40    loss=0.1012 [7.2 s]    dev=(HR@5:0.3855,NDCG@5:0.2827) [0.6 s] *
INFO:root:Epoch 41    loss=0.0986 [7.2 s]    dev=(HR@5:0.3840,NDCG@5:0.2778) [0.7 s]
INFO:root:Epoch 42    loss=0.0967 [7.2 s]    dev=(HR@5:0.3854,NDCG@5:0.2802) [0.6 s]
INFO:root:Epoch 43    loss=0.0923 [7.3 s]    dev=(HR@5:0.3846,NDCG@5:0.2810) [0.6 s]
INFO:root:Epoch 44    loss=0.0930 [7.4 s]    dev=(HR@5:0.3831,NDCG@5:0.2790) [0.7 s]
INFO:root:Epoch 45    loss=0.0894 [7.1 s]    dev=(HR@5:0.3776,NDCG@5:0.2758) [0.6 s]
INFO:root:Epoch 46    loss=0.0887 [7.2 s]    dev=(HR@5:0.3779,NDCG@5:0.2741) [0.6 s]
INFO:root:Epoch 47    loss=0.0872 [7.2 s]    dev=(HR@5:0.3811,NDCG@5:0.2767) [0.6 s]
INFO:root:Epoch 48    loss=0.0860 [7.6 s]    dev=(HR@5:0.3843,NDCG@5:0.2796) [0.6 s]
INFO:root:Epoch 49    loss=0.0854 [7.2 s]    dev=(HR@5:0.3836,NDCG@5:0.2806) [0.6 s]
INFO:root:Epoch 50    loss=0.0830 [7.7 s]    dev=(HR@5:0.3816,NDCG@5:0.2794) [0.7 s]
INFO:root:Epoch 51    loss=0.0825 [7.4 s]    dev=(HR@5:0.3872,NDCG@5:0.2808) [0.7 s]
INFO:root:Epoch 52    loss=0.0788 [7.3 s]    dev=(HR@5:0.3828,NDCG@5:0.2809) [0.6 s]
INFO:root:Epoch 53    loss=0.0815 [7.2 s]    dev=(HR@5:0.3885,NDCG@5:0.2844) [0.6 s] *
INFO:root:Epoch 54    loss=0.0772 [7.1 s]    dev=(HR@5:0.3847,NDCG@5:0.2814) [0.6 s]
INFO:root:Epoch 55    loss=0.0759 [7.3 s]    dev=(HR@5:0.3808,NDCG@5:0.2775) [0.6 s]
INFO:root:Epoch 56    loss=0.0756 [7.5 s]    dev=(HR@5:0.3806,NDCG@5:0.2776) [0.6 s]
INFO:root:Epoch 57    loss=0.0733 [7.1 s]    dev=(HR@5:0.3834,NDCG@5:0.2809) [0.6 s]
INFO:root:Epoch 58    loss=0.0720 [7.1 s]    dev=(HR@5:0.3861,NDCG@5:0.2831) [0.6 s]
INFO:root:Epoch 59    loss=0.0707 [7.2 s]    dev=(HR@5:0.3871,NDCG@5:0.2838) [0.6 s]
INFO:root:Epoch 60    loss=0.0714 [7.7 s]    dev=(HR@5:0.3829,NDCG@5:0.2797) [0.7 s]
INFO:root:Epoch 61    loss=0.0691 [7.6 s]    dev=(HR@5:0.3871,NDCG@5:0.2831) [0.6 s]
INFO:root:Epoch 62    loss=0.0686 [7.5 s]    dev=(HR@5:0.3839,NDCG@5:0.2813) [0.7 s]
INFO:root:Epoch 63    loss=0.0661 [7.1 s]    dev=(HR@5:0.3859,NDCG@5:0.2833) [0.6 s]
INFO:root:Epoch 64    loss=0.0679 [7.3 s]    dev=(HR@5:0.3865,NDCG@5:0.2834) [0.6 s]
INFO:root:Epoch 65    loss=0.0652 [7.6 s]    dev=(HR@5:0.3853,NDCG@5:0.2822) [0.6 s]
INFO:root:Epoch 66    loss=0.0636 [7.5 s]    dev=(HR@5:0.3850,NDCG@5:0.2823) [0.6 s]
INFO:root:Epoch 67    loss=0.0627 [7.7 s]    dev=(HR@5:0.3806,NDCG@5:0.2778) [0.6 s]
INFO:root:Epoch 68    loss=0.0617 [7.6 s]    dev=(HR@5:0.3814,NDCG@5:0.2817) [0.6 s]
INFO:root:Epoch 69    loss=0.0618 [7.1 s]    dev=(HR@5:0.3823,NDCG@5:0.2832) [0.6 s]
INFO:root:Epoch 70    loss=0.0613 [7.2 s]    dev=(HR@5:0.3797,NDCG@5:0.2777) [0.6 s]
INFO:root:Epoch 71    loss=0.0596 [7.0 s]    dev=(HR@5:0.3837,NDCG@5:0.2823) [0.6 s]
INFO:root:Epoch 72    loss=0.0601 [7.2 s]    dev=(HR@5:0.3792,NDCG@5:0.2794) [0.6 s]
INFO:root:Epoch 73    loss=0.0579 [6.8 s]    dev=(HR@5:0.3847,NDCG@5:0.2854) [0.6 s] *
INFO:root:Epoch 74    loss=0.0585 [6.8 s]    dev=(HR@5:0.3810,NDCG@5:0.2801) [0.6 s]
INFO:root:Epoch 75    loss=0.0583 [6.9 s]    dev=(HR@5:0.3776,NDCG@5:0.2778) [0.6 s]
INFO:root:Epoch 76    loss=0.0552 [6.7 s]    dev=(HR@5:0.3783,NDCG@5:0.2796) [0.6 s]
INFO:root:Epoch 77    loss=0.0553 [7.2 s]    dev=(HR@5:0.3810,NDCG@5:0.2828) [0.6 s]
INFO:root:Epoch 78    loss=0.0543 [7.1 s]    dev=(HR@5:0.3816,NDCG@5:0.2828) [0.6 s]
INFO:root:Epoch 79    loss=0.0531 [7.2 s]    dev=(HR@5:0.3784,NDCG@5:0.2782) [0.6 s]
INFO:root:Epoch 80    loss=0.0549 [7.1 s]    dev=(HR@5:0.3802,NDCG@5:0.2817) [0.7 s]
INFO:root:Epoch 81    loss=0.0529 [7.2 s]    dev=(HR@5:0.3831,NDCG@5:0.2838) [0.6 s]
INFO:root:Epoch 82    loss=0.0523 [7.0 s]    dev=(HR@5:0.3784,NDCG@5:0.2792) [0.6 s]
INFO:root:Epoch 83    loss=0.0526 [7.2 s]    dev=(HR@5:0.3753,NDCG@5:0.2765) [0.6 s]
INFO:root:Epoch 84    loss=0.0515 [7.2 s]    dev=(HR@5:0.3829,NDCG@5:0.2828) [0.6 s]
INFO:root:Epoch 85    loss=0.0509 [7.2 s]    dev=(HR@5:0.3842,NDCG@5:0.2827) [0.6 s]
INFO:root:Epoch 86    loss=0.0500 [7.1 s]    dev=(HR@5:0.3837,NDCG@5:0.2830) [0.6 s]
INFO:root:Epoch 87    loss=0.0499 [7.0 s]    dev=(HR@5:0.3763,NDCG@5:0.2779) [0.6 s]
INFO:root:Epoch 88    loss=0.0488 [6.9 s]    dev=(HR@5:0.3783,NDCG@5:0.2786) [0.6 s]
INFO:root:Epoch 89    loss=0.0490 [7.1 s]    dev=(HR@5:0.3886,NDCG@5:0.2874) [0.6 s] *
INFO:root:Epoch 90    loss=0.0486 [6.8 s]    dev=(HR@5:0.3795,NDCG@5:0.2804) [0.6 s]
INFO:root:Epoch 91    loss=0.0483 [7.1 s]    dev=(HR@5:0.3767,NDCG@5:0.2765) [0.6 s]
INFO:root:Epoch 92    loss=0.0462 [7.3 s]    dev=(HR@5:0.3757,NDCG@5:0.2782) [0.6 s]
INFO:root:Epoch 93    loss=0.0485 [7.1 s]    dev=(HR@5:0.3788,NDCG@5:0.2797) [0.6 s]
INFO:root:Epoch 94    loss=0.0468 [7.2 s]    dev=(HR@5:0.3819,NDCG@5:0.2832) [0.6 s]
INFO:root:Epoch 95    loss=0.0461 [7.4 s]    dev=(HR@5:0.3814,NDCG@5:0.2820) [0.6 s]
INFO:root:Epoch 96    loss=0.0452 [7.6 s]    dev=(HR@5:0.3772,NDCG@5:0.2790) [0.6 s]
INFO:root:Epoch 97    loss=0.0453 [7.0 s]    dev=(HR@5:0.3767,NDCG@5:0.2787) [0.6 s]
INFO:root:Epoch 98    loss=0.0461 [6.7 s]    dev=(HR@5:0.3718,NDCG@5:0.2768) [0.6 s]
INFO:root:Epoch 99    loss=0.0433 [6.8 s]    dev=(HR@5:0.3778,NDCG@5:0.2805) [0.6 s]
INFO:root:Epoch 100   loss=0.0436 [6.8 s]    dev=(HR@5:0.3787,NDCG@5:0.2822) [0.6 s]
INFO:root:Epoch 101   loss=0.0441 [6.8 s]    dev=(HR@5:0.3767,NDCG@5:0.2807) [0.6 s]
INFO:root:Epoch 102   loss=0.0440 [7.0 s]    dev=(HR@5:0.3829,NDCG@5:0.2848) [0.6 s]
INFO:root:Epoch 103   loss=0.0417 [6.8 s]    dev=(HR@5:0.3797,NDCG@5:0.2811) [0.6 s]
INFO:root:Epoch 104   loss=0.0433 [6.9 s]    dev=(HR@5:0.3748,NDCG@5:0.2791) [0.6 s]
INFO:root:Epoch 105   loss=0.0392 [6.9 s]    dev=(HR@5:0.3780,NDCG@5:0.2808) [0.6 s]
INFO:root:Epoch 106   loss=0.0412 [6.8 s]    dev=(HR@5:0.3808,NDCG@5:0.2826) [0.6 s]
INFO:root:Epoch 107   loss=0.0415 [6.8 s]    dev=(HR@5:0.3798,NDCG@5:0.2818) [0.6 s]
INFO:root:Epoch 108   loss=0.0410 [7.1 s]    dev=(HR@5:0.3791,NDCG@5:0.2798) [0.6 s]
INFO:root:Epoch 109   loss=0.0409 [6.8 s]    dev=(HR@5:0.3785,NDCG@5:0.2793) [0.6 s]
INFO:root:Early stop at 109 based on dev result.
INFO:root:
Best Iter(dev)=   89	 dev=(HR@5:0.3886,NDCG@5:0.2874) [855.2 s] 
INFO:root:Load model from ../model/GRU4Rec/GRU4Rec__Grocery_and_Gourmet_Food__0__lr=0.001__l2=1e-06__emb_size=64__hidden_size=64.pt
INFO:root:
Test After Training: (HR@5:0.3412,NDCG@5:0.2484,HR@10:0.4432,NDCG@10:0.2813,HR@20:0.5683,NDCG@20:0.3127,HR@50:0.7965,NDCG@50:0.3578)
INFO:root:
--------------------------------------------- END: 2023-06-19 23:28:57 ---------------------------------------------
